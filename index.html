
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WeatherApp</title>
  <link rel="stylesheet" href="style.css">

   <!-- fontawesome  -->
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/all.css"
    />
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-duotone-solid.css"
    />
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-thin.css"
    />
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-solid.css"
    />
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-regular.css"
    />
    <link
      rel="stylesheet"
      href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-light.css"
    />


</head>


<body>
  <div class="card glass">
    <div class="search">
      <input type="text" placeholder="Search city..." spellcheck="false"/>
      <button><img src="images/search.png" alt="Search"/></button>
    </div>

    <div class="error">
      <p>Invalid city name</p>
    </div>

    <div class="weather">
      <img src="images/rain.png" class="weather-icon" alt=""/>
      <h1 class="temp">20째c</h1>
      <h2 class="city">London</h2>
      <div class="details">
        <div class="col">
          <img src="images/humidity.png" alt=""/>
          <div>
            <p class="humidity">50%</p>
            <span>Humidity</span>
          </div>
        </div>
        <div class="col">
          <img src="images/wind.png" alt=""/>
          <div>
            <p class="wind">20 km/h</p>
            <span>Wind</span>
          </div>
        </div>
      </div>
      <div class="details">
        <div class="col">
          <i class="fa-thin fa-temperature-arrow-up fa-2xl icon-white" style="color: #fff"></i>
          <div>
            <p class="maxtemp">50%</p>
            <span>Max temp</span>
          </div>
        </div>
        <div class="col">
          <i class="fa-thin fa-arrows-down-to-line fa-2xl icon-white" style="color: #fff"></i>
          <div>
            <p class="pressure">50%</p>
            <span>Air pressure</span>
          </div>
        </div>
      </div>
    </div>


    <div class="forecast">
      <!-- add 6 days forecast here -->
    </div>

  <script>
    const apiKey = "398290e8c72f063076c062640c9db2c9";
    // const apiUrl = "https://api.openweathermap.org/data/2.5/weather?&units=metric&q=";
    const apiUrl = "https://api.openweathermap.org/data/2.5/forecast?&units=metric&q="

    const searchBox = document.querySelector(".search input");
    const searchBtn = document.querySelector(".search button");
    const weatherIcon = document.querySelector(".weather-icon");
    const locationIcon = document.getElementById("locationicon");

    window.addEventListener("DOMContentLoaded", getWeatherInfo("paris"))

    //call weather API to fetching weather data inside this async function
    async function getWeatherInfo(city){

      let response = await fetch(apiUrl + city + `&appid=${apiKey}`);

      if(response.status == 404){
        document.querySelector(".error").style.display = "block";
        document.querySelector(".weather").style.display = "none";
      }
      else{
      var data = await response.json();
      let todayData = data
      console.log(todayData);

      document.querySelector(".temp").innerHTML = Math.round(todayData.list[0].main.temp) + "째c";
      document.querySelector(".city").innerHTML = `<i class="fa-regular fa-location-dot fa-sm"></i> ${todayData.city.name}`;
      document.querySelector(".humidity").innerHTML = todayData.list[0].main.humidity + "%";
      document.querySelector(".wind").innerHTML = todayData.list[0].wind.speed + " km/h";
      document.querySelector(".maxtemp").innerHTML = Math.round(todayData.list[0].main.temp_max) + "째c";
      document.querySelector(".pressure").innerHTML = todayData.list[0].main.pressure;
      
      
      //weather icon according to weather forecast
      if(todayData.list[0].weather[0].main == "Clouds"){
        weatherIcon.src = "images/clouds.png";
      }
      else if(todayData.list[0].weather[0].main == "Clear"){
        weatherIcon.src = "images/clear.png";
      }
      else if(todayData.list[0].weather[0].main == "Drizzle"){
        weatherIcon.src = "images/drizzle.png";
      }
      else if(todayData.list[0].weather[0].main == "Rain"){
        weatherIcon.src = "images/rain.png";
      }
      else if(todayData.list[0].weather[0].main == "Mist"){
        weatherIcon.src = "images/mist.png";
      }
      else if(todayData.list[0].weather[0].main == "Snow"){
        weatherIcon.src = "images/snow.png";
      }
      console.log(data)

      forecast(data.list);

      document.querySelector(".weather").style.display = "block";
      document.querySelector(".error").style.display = "none";
      }
    };


    //next 6 days forecast
    function forecast(arr){
      let statement = ``;
      let forecastDays = [];
      
      arr.forEach((item)=>{
        let date = new Date(item.dt * 1000).toLocaleDateString();
        if(!forecastDays.find(day => day.date === date)){
          forecastDays.push({date: date, data: item});
        }
      });
      console.log(forecastDays)

      forecastDays.slice(1, 7).forEach((day, index)=>{
        let iconSrc = "images/clear.png";
        if(day.data.weather[0].main == "Clouds"){
          iconSrc = "images/clouds.png";
        }
        else if(day.data.weather[0].main == "Rain"){
          iconSrc = "images/rain.png";
        }
        else if(day.data.weather[0].main == "Drizzle"){
          iconSrc = "images/drizzle.png";
        }
        else if(day.data.weather[0].main == "Mist"){
          iconSrc = "images/mist.png";
        }
        else if(day.data.weather[0].main == "Snow"){
          iconSrc = "images/snow.png";
        }

        statement += `<div class="col">
        <h6>${day.date}</h6>
        <img src="${iconSrc}" alt="" />
        <p class="forecast-temp">${Math.round(day.data.main.temp)}째c</p>
        </div>`
    });
    document.querySelector(".forecast").innerHTML = statement;

    document.querySelector(".forecast").style.display = "block";
    document.querySelector(".forecast").style.display = "flex";
  }


    //search by city weather button event
    searchBtn.addEventListener("click", ()=>{
      getWeatherInfo(searchBox.value);
    });

    </script>
</body>
</html>
